import { loadServerPlugins as loadServerPluginInstances } from "@modern-js/prod-server";
async function getServerPlugins(api, metaName = "modern-js") {
  const runner = api.useHookRunners();
  const { plugins } = await runner._internalServerPlugins({
    plugins: []
  });
  const filtedPlugins = plugins.filter((plugin) => plugin.name.includes(metaName));
  api.setAppContext({
    ...api.useAppContext(),
    serverPlugins: filtedPlugins
  });
  return filtedPlugins;
}
async function loadServerPlugins(api, appDirectory, metaName) {
  const plugins = await getServerPlugins(api, metaName);
  const instances = await loadServerPluginInstances(plugins, appDirectory);
  return instances;
}
export {
  getServerPlugins,
  loadServerPlugins
};
